---
classoption: landscape
---

```{r echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
library(dataRetrieval)
library(dplyr)
library(tidyr)

source("../R/functions-qwtable.R")
```

```{r echo=FALSE, warning=FALSE, message=FALSE, comment=NA}
wy_dates <- convertWYtoDate(wy)
wy_start <- wy_dates$wy_start
wy_end <- wy_dates$wy_end

pcodes <- read.csv("../data/pcodes.lakes1",header=FALSE,
                   colClasses = "character")[,1]

qw_nwis <- tryCatch({readNWISqw(siteNumbers = siteNumber, 
                               parameterCd = pcodes, 
                               startDate = wy_start, 
                               endDat = wy_end)},
                    error = function(err){
                      return(NULL)
                    })

if(!is.null(qw_nwis)){
  qwtable <- makeWqTable(qw_nwis)
} else {
  cat("No data returned for", siteNumber, "from", as.character(wy_start), "to", as.character(wy_end))
}
```

`r isWord <- !is.null(qw_nwis) & output == "word"`
`r isOther <- !is.null(qw_nwis) & output != "word"`

```{r eval = isOther, echo=FALSE, warning=FALSE, message=FALSE, results='asis'} 
library(xtable)

qwtable$sample_dt <- as.character(qwtable$sample_dt)

options(xtable.comment = FALSE)
qw_xtable <- xtable(qwtable, auto=TRUE)
print.xtable(qw_xtable, NA.string = "--", include.rownames=FALSE)
```


```{r eval = isWord, echo=FALSE, warning=FALSE, message=FALSE, results='asis'} 
library(pander)
panderOptions('missing', '--')
panderOptions('digits', 4)
panderOptions('keep.trailing.zeros', TRUE)
panderOptions('table.continues', NULL)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.default', 'left')
pander(qwtable)
```
